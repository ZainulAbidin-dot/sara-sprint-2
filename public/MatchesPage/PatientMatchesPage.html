<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="PatientMatchesPage.css">
    <link rel="stylesheet" href="../PostHeader/PostHeader.css">
    <link rel="stylesheet" href="../Prefooter/Prefooter.css">
    <link rel="stylesheet" href="../Prefooter/Prefooter.js">
</head>
<body>
    <header class="header">
        <div class="header-logo">
            <span>T</span>ADAWI
        </div>
        <nav class="nav">
            <!--<div class="container" id="trials-container"></div> to retrieve the info from db-->
            <a href="../Home/HomePage-Patient.html">Home</a>
            <a href="../ClinicalTrialPage/CTpage.html">Clinical Trials</a>
            <a href="../MatchesPage/PatientMatchesPage.html">Matches</a>
            <a href="../About-us/About-usPostPatient.html">About us</a>
            <a href="../HelpPage/Help-Patient.html">Help</a>
            <a href="../NotificationsPage/P-NotifPage.html">Notifications</a>
        </nav>
        
        <div class="buttons-container">
            <img src=""  id="">

            <a href="../Chatbox/Patient-Chatbox.html" id="chatbox">
                <button>ChatBox</button>
            </a>

            <!-- Sign Out Button -->
            <a href="../Home/HomePage.html" id="signout-btn">
                <button>Sign Out</button>
            </a>

            <!-- Edit Profile Button -->
            <a href="../EditProfile/EditProfile-Patient.html">
                <button id="edit-btn">Edit Profile</button>
            </a>
        </div>
    </header>
    <div class="container">
        <div class="card">
            <p><strong>Name: DR. Mahmoud Ali</strong></p>
            <p><strong>Duration: Six Months</strong></p>
            <p><strong>Disease: Breast Cancer</strong></p>
            <p><strong>Risk Level: Low </strong></p>
            <p><strong>Start Date: 22/02/2025 </strong></p>
            <p><strong>Status: <span class="status" data-trial-id="trial1">Loading...</span></strong></p>
            <div class="buttons">
                <button class="matched">Matched</button>
                <button class="contact">Contact</button>
            </div>
        </div>
        
        <div class="card">
            <p><strong>Name: DR. Somayh Ahmad</strong></p>
            <p><strong>Duration: Two Years</strong></p>
            <p><strong>Disease: Sickel Cell</strong></p>
            <p><strong>Risk Level: High </strong></p>
            <p><strong>Start Date: 15/02/2027 </strong></p>
            <p><strong>Status: <span class="status" data-trial-id="trial2">Loading...</span></strong></p>
            <div class="buttons">
                <button class="matched">Matched</button>
                <button class="contact">Contact</button>
            </div>
        </div>
        
        <div class="card">
            <p><strong>Name: DR. Bassam Alqahtani</strong></p>
            <p><strong>Duration: Three Weeks</strong></p>
            <p><strong>Disease: Tuberculosis</strong></p>
            <p><strong>Risk Level: High </strong></p>
            <p><strong>Start Date: 22/06/2025 </strong></p>
            <p><strong>Status: <span class="status" data-trial-id="trial3">Loading...</span></strong></p>
            <div class="buttons">
                <button class="matched">Matched</button>
                <button class="contact">Contact</button>
            </div>
        </div>
        
        <div class="card">
            <p><strong>Name: DR. Alia Mohammad</strong></p>
            <p><strong>Duration: One Year</strong></p>
            <p><strong>Disease: Leukemia </strong></p>
            <p><strong>Risk Level: Medium </strong></p>
            <p><strong>Start Date: 11/08/2025 </strong></p>
            <p><strong>Status: <span class="status" data-trial-id="trial4">Loading...</span></strong></p>
            <div class="buttons">
                <button class="matched">Matched</button>
                <button class="contact">Contact</button>
            </div>
        </div>
        
    </div>
    <script>
     
     document.addEventListener("DOMContentLoaded", function() {
    // Contact button redirection
    document.querySelectorAll(".contact").forEach(button => {
        button.addEventListener("click", function() {
            window.location.href = "../matchespage/PcontactDr.html";
        });
    });

    // Matched button alert
    document.querySelectorAll(".matched").forEach(button => {
        button.addEventListener("click", function() {
            alert("You are matched with this clinical trial.");
        });
    });

    // Sign out button logic
    document.getElementById("signout-btn").addEventListener("click", function(event) {
        event.preventDefault();
        alert("You have signed out!");
        window.location.href = "../Home/HomePage.html";
    });

    // Underline the current tab
    let currentLocation = window.location.pathname.split("/").pop();
    let navLinks = document.querySelectorAll(".nav a");
    navLinks.forEach(link => {
        if (link.getAttribute("href").includes(currentLocation)) {
            link.classList.add("active");
        } else {
            link.classList.remove("active");
        }
    });

    // Fetch match status from backend
    async function fetchMatchStatus() {
        const userId = localStorage.getItem("userId"); // Assuming userId is stored after login

        if (!userId) {
            console.error("User ID not found.");
            return;
        }

        try {
            const response = await fetch(`https://your-api-url.com/api/get-match-status/${userId}`);
            const data = await response.json();

            document.querySelectorAll(".status").forEach(span => {
                const trialId = span.getAttribute("data-trial-id");
                const trialStatus = data.find(trial => trial.trialId === trialId);

                if (trialStatus) {
                    span.textContent = trialStatus.status; // "Approved", "Pending", or "Rejected"
                    span.style.color = trialStatus.status === "Approved" ? "green" :
                                       trialStatus.status === "Rejected" ? "red" : "orange";
                } else {
                    span.textContent = "Unknown";
                    span.style.color = "gray";
                }
            });

        } catch (error) {
            console.error("Error fetching match status:", error);
        }
    }

    fetchMatchStatus(); // Call function to get status from DB
});

    </script>
    <footer class="footer">
        <div class="columns">
            <div class="column">
                <h3>Providers</h3>
                <p>MedNova Pharma</p>
                <p>BioGenesis Pharma</p>
                <p>CureTech Solutions</p>
                <p>LifeBridge Investments</p>
                <p>MedStrive Holdings</p>
                <p>SummitCare Hospital</p>
            </div>
            <div class="column">
                <h3>Publications</h3>
                <p>The Journal of Global Health Insights</p>
                <p>Biotech Review</p>
                <p>PharmaProgress</p>
                <p>Innovative Medical Research</p>
                <p>Future of Healthcare</p>
            </div>
            <div class="column">
                <h3>Investors</h3>
                <p>CapitalCore Ventures</p>
                <p>SilverStone Investments</p>
                <p>Pioneer Growth Partners</p>
                <p>Summit Ridge Capital</p>
                <p>Horizon Equity Group</p>
            </div>
        </div>
        <div class="contact">
            Contact us at : <a href="mailto:tadawi@gmail.com">tadawi.contact@gmail.com</a>
        </div>
        <div class="logos">
            
            <img src="../img/vision2030-saudi-arabia-Logo-PNG-Transparent-Background.png" alt="Logo 2">
            <img src="../img/logo (1).png" alt="Logo 3">
            <img src="../img/image-removebg-preview.png" alt="Logo 4">
        </div>
    </footer>
</body>
</html>
